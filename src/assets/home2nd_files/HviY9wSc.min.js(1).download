window.Dmdbase_CDC={},window.Dmdbase_CDC={cookieName:"dmdbase_cdc",dimensions:{},logging:!1,enableTNT:!1,enableAnalytics:!0,DB_DEFAULT_VALUE:"ISP Visitor",NOT_IN_AWLIST:"Not In List",NOT_ASSIGNED_AWLIST_VALUE:"In List No Value",CompanyProfile:{},targetAttributes:["demandbase_sid","company_name","industry","sub_industry","employee_range","revenue_range","audience","audience_segment","state","country_name","marketing_alias","b2b","b2c,","web_site","watch_list_account_type","watch_list_account_status"],useStorage:!0,useCookie:!0,targetReady:!1,init:function(){"true"===this.cdc_getParamByName("cdc_debug")&&(this.logging=!0)},setupDimensions:function(){this.dimensions.set1={demandbase_sid:10,company_name:40,industry:40,sub_industry:40,employee_range:30,revenue_range:10,audience:30,audience_segment:30},this.dimensions.set2={marketing_alias:35,city:50,state:5,country_name:20,watch_list_account_type:30,watch_list_account_status:30,watch_list_source_name_grouping:30,watch_list_isp_service:30},this.dimensions.set3={watch_list_is_sc:30,watch_list_is_sp:30,watch_list_is_abm:30,watch_list_is_champion:30,watch_list_vertical:30,watch_list_is_industry:30,watch_list_is_domain:30,watch_list_duns_number:30},this.dimensions.set4={watch_list_account_360:30,placeholder2:30,placeholder3:30,placeholder4:30,placeholder5:30,placeholder6:30,placeholder7:30,placeholder8:30}},callback:function(e){if(e)try{window.Dmdbase_CDC.init(),e=this.flatten(e),window.Dmdbase_CDC.CompanyProfile=e,this.enableAnalytics&&this.setAnalytics(window.Dmdbase_CDC.CompanyProfile),this.enableTNT&&this.setMbox(window.Dmdbase_CDC.CompanyProfile)}catch(e){window.console&&this.logging&&console.log("DB _ "+e.message)}},loadAnalytics:function(){this.setAnalytics(window.Dmdbase_CDC.CompanyProfile)},setAnalytics:function(e){try{if(this.setupDimensions(),window.sessionStorage)!sessionStorage.getItem("s_dmdbase")&&this.isCookieSet(this.cookieName)&&this.storeSessionData(e);this.isCookieSet(this.cookieName)||this.storeSessionData(e)}catch(e){window.console&&this.logging&&console.log("DB _ "+e.message)}},storeSessionData:function(e){var t=this.buildDelimitedStrings(":",e);if(this.isCookieSet(this.cookieName)||this.saveToCookie(this.cookieName,"DBSET",1),window.Dmdbase_CDC.contextData=t,window.sessionStorage&&this.useStorage){sessionStorage.setItem("s_dmdbase",window.Dmdbase_CDC.contextData[0]);for(var i=1;i<window.Dmdbase_CDC.contextData.length;i++)sessionStorage.setItem("s_dmdbase_custom"+i,window.Dmdbase_CDC.contextData[i])}},setMbox:function(e){try{null!==window.TNT&&"object"==typeof window.TNT&&this.set_mbox_variables(e)}catch(e){window.console&&this.logging&&console.log("DB _ "+e.message)}},flatten:function(e){for(var t in e)if("object"==typeof e[t]&&null!==e[t]&&e.hasOwnProperty(t)){for(var i in e[t])e[t].hasOwnProperty(i)&&(e[t+"_"+i]=e[t][i]);delete e[t]}return e},saveToCookie:function(e,t){var i=new Date;i.setTime(i.getTime()+18e5);var s="; expires="+i.toGMTString(),n=document.location.href,o="; domain="+this.getDomain(n);document.cookie=e+"="+encodeURIComponent(t)+s+o+"; path=/"},getCookieByName:function(e){e+="=";for(var t=document.cookie.split(";"),i=0;i<t.length;i++){for(var s=t[i];" "==s.charAt(0);)s=s.substring(1);if(-1!=s.indexOf(e))return decodeURIComponent(s.substring(e.length,s.length))}return""},getHostName:function(e){var t=e.match(/:\/\/(www[0-9]?\.)?(.[^\/:]+)/i);return null!=t&&t.length>2&&"string"==typeof t[2]&&t[2].length>0?t[2]:null},getDomain:function(e){var t=this.getHostName(e),i=t;if(null!=t){var s=t.split(".").reverse();null!=s&&s.length>1&&(i="."+s[1]+"."+s[0],-1!=t.toLowerCase().indexOf(".co.uk")&&s.length>2&&(i="."+s[2]+"."+i))}return i},isCookieSet:function(e){var t=this.getCookieByName(e);return t&&"undefined"!=t},buildDelimitedStrings:function(e,t){var i=this.dimensions,s=[];for(var n in i)if(i.hasOwnProperty(n)){var o="";for(var a in i[n])if(i[n].hasOwnProperty(a)){var r="";r=-1!=a.indexOf("watch_list")&&"Detailed"===t.information_level&&t.hasOwnProperty(a)?this.truthy(t[a],this.NOT_ASSIGNED_AWLIST_VALUE):-1==a.indexOf("watch_list")||"Detailed"!==t.information_level||t.hasOwnProperty(a)?this.truthy(t[a],this.DB_DEFAULT_VALUE):this.truthy(t[a],this.NOT_IN_AWLIST);var c=i[n][a];o+=(r=this.resizeStr(r,c))+e}o=o.substring(0,o.length-1),o=this.resizeStr(o,255),s.push(o)}return s},resizeStr:function(e,t){return e.length>t&&(e=e.substring(0,t)),e},truthy:function(e,t){return e||(!1===e?e:t)},cdc_getParamByName:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},set_mbox_variables:function(e){try{var t="";for(var i in e){if(e.hasOwnProperty(i))if(-1!=this.targetAttributes.indexOf(i))t+="profile."+i+"="+e[i]+","}t=t.split(","),"undefined"!=typeof mboxFactoryDefault&&mboxFactoryDefault.getUrlBuilder().addParameters(t)}catch(e){console.log(e)}}};
